---
/*
  Critical render-path bootloader.
  Inlines void-boot.js and hydrates immediately to prevent FOUC.
*/

import THEME_REGISTRY from '../../config/void-registry.json';
import { STORAGE_KEYS, DOM_ATTRS, DEFAULTS } from '../../config/constants';

// Import bootloader as a raw string for inline execution.
import bootSource from '../../lib/void-boot.js?raw';

// Strip exports for inline <script> execution.
const cleanBootSource = bootSource.replace(/export /g, '');
---

<script
  is:inline
  set:html={`
    (function() {
      // Inject bootloader.
      ${cleanBootSource}

      // Execute hydration with server-side constants.
      hydrate(
        ${JSON.stringify(THEME_REGISTRY)}, 
        ${JSON.stringify(STORAGE_KEYS)}, 
        ${JSON.stringify(DOM_ATTRS)}, 
        ${JSON.stringify(DEFAULTS)}
      );
    })();
  `}
/>
