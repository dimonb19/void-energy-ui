/*
 * ROLE: Triad Engine Entry Point
 * RESPONSIBILITY: Initializes Physics and Atmosphere layers independently.
 */

@use 'sass:map';
@use '../abstracts/physics-presets' as physics;
@use '../abstracts/theme-engine' as engine;
@use '../config/generated-themes' as config;

// 1. GLOBAL FALLBACKS (:root)
// We inject the default "Void" + "Glass" tokens into :root.
// This ensures the UI has shape and color before JS hydrates the attributes.
:root {
  // A. Default Physics (Glass)
  $default-physics: map.get(physics.$physics-presets, 'glass');

  @each $key, $val in $default-physics {
    --#{$key}: #{$val};
  }

  // B. Default Atmosphere (Void)
  $default-theme: map.get(config.$themes, 'void');
  $default-palette: map.get($default-theme, 'palette');

  color-scheme: dark;
  @each $key, $val in $default-palette {
    --#{$key}: #{$val};
  }
}

// 2. EMIT PHYSICS LAYER
// Generates: [data-physics="glass"], [data-physics="flat"], etc.
@include physics.emit-physics;

// 3. EMIT ATMOSPHERE LAYER
// Generates: [data-atmosphere="void"], [data-atmosphere="onyx"], etc.
@each $name, $theme-config in config.$themes {
  @include engine.generate-atmosphere($name, $theme-config);
}
